<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-F9Y0YKG55S"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-F9Y0YKG55S")</script><link rel=canonical href=https://vald.vdaas.org><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=robots content='index, follow'><title>Vald | Architecture</title>
<meta name=description content="Vald is high scalable distributed high-speed approximate nearest neighbor search engine" }><meta name=format-detection content="telephone=no"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta property="og:type" content="article"><meta property="og:title" content="Vald | Architecture"><meta property="og:description" content="Vald is high scalable distributed high-speed approximate nearest neighbor search engine"><meta property="og:url" content="https://vald.vdaas.org/docs/v1.3/overview/architecture/"><meta property="og:image" content="https://vald.vdaas.org//images/ogp_vald.png"><meta property="og:site_name" content="vald"><meta property="og:locale" content="en_US"><meta property="fb:app_id" content="615732422350002"><meta name=twitter:site content="@vdaas_vald"><meta name=twitter:card content="app"><link rel="shortcut icon" href=https://vald.vdaas.org//favicon.ico><link rel=stylesheet type=text/css href=/css/style.min.css><link rel=stylesheet type=text/css href=/css/header.min.css><link rel=stylesheet type=text/css href=/css/footer.min.css><link rel=stylesheet type=text/css href=/css/main.min.css><script type=text/javascript src=/js/script.min.js defer></script><meta name=viewport content="target-densitydpi=device-dpi,width=device-width,maximum-scale=1,user-scalable=yes"></head><body><header class=header id=header><div class=header__content><nav class=header__nav><a href=https://vald.vdaas.org/ class=header-nav__link><picture class=header-nav__image><source srcset=https://vald.vdaas.org//images/vald_white.svg media="(prefers-color-scheme: dark)"><img src=https://vald.vdaas.org//images/vald_color_1.svg alt>
</picture></a><a class=header-nav__icon id=nav-btn><span class=header-nav__button></span></a><ul class=header__list id=menu><li class=header__item><a href=/docs/v1.3/overview/about-vald class=header__link>About</a></li><li class=header__item><a href=/docs/v1.3/tutorial/get-started class=header__link>Get Started</a></li><li class=header__item><a href=/docs/v1.3/user-guides/sdks class=header__link>SDKs</a></li><li class=header__item><a href=/docs/v1.3 class=header__link>Docs</a></li><li class=header__item><a href=https://vdaas-vald.medium.com/ target=_blank class=header__link>Blog<br></a></li><li class=header__item><details class=header__version id=version_details><summary class=version__current id=current_version>v1.3</summary><ul class=version__list><il class=version__item><a href=javascript:void(0) class="version__link version__link--latest">v1.7.16</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.7</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.6</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.5</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.4</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.3</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.2</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.1</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.0</a></il></ul></details></li><li class=header__item><a class=header__git href=https://github.com/vdaas/vald target=_blank><picture class=git__logo><source srcset=https://vald.vdaas.org//images/logo_github_white.svg media="(prefers-color-scheme: dark)" width=18 height=18><img src=https://vald.vdaas.org//images/logo_github_black.svg alt=github width=18 height=18></picture><div class=git__star><p class=git__starnum id=git-star-num></p></div></a></li></ul></nav></div></header><main role=main><div class=single><aside class=page><nav><ul id=list-body><li class=withchild id=cat_Overview>Overview<ul><li class=index><a href=/docs/v1.3/overview/about-vald/>About Vald</a></li><li class=view><a href=/docs/v1.3/overview/architecture/>Architecture</a></li><li class=index><a href=/docs/v1.3/overview/data-flow/>Data Flow</a></li></ul></li><li class=withchild id=cat_Component>Component<ul></ul></li><li class=withchild id=cat_Tutorial>Tutorial<ul><li class=index><a href=/docs/v1.3/tutorial/get-started/>Get Started</a></li><li class=index><a href=/docs/v1.3/tutorial/vald-agent-standalone-on-docker/>Vald Agent Standalone on Docker</a></li><li class=index><a href=/docs/v1.3/tutorial/vald-agent-standalone-on-k8s/>Vald Agent Standalone on K8s</a></li></ul></li><li class=withchild id=cat_Usecase>Usecase<ul><li class=index><a href=/docs/v1.3/usecase/usage-example/>Usage Example</a></li></ul></li><li class=withchild id="cat_User Guides">User Guides<ul><li class=index><a href=/docs/v1.3/user-guides/configuration/>Configuration</a></li><li class=index><a href=/docs/v1.3/user-guides/operations/>Operations</a></li><li class=index><a href=/docs/v1.3/user-guides/sdks/>Sdks</a></li></ul></li><li class=withchild id=cat_Performance>Performance<ul><li class=index><a href=/docs/v1.3/performance/benchmark/>Benchmark</a></li><li class=index><a href=/docs/v1.3/performance/loadtest/>Loadtest</a></li></ul></li><li class=withchild id=cat_Api>API<ul><li class=index><a href=/docs/v1.3/api/insert/>Insert</a></li><li class=index><a href=/docs/v1.3/api/update/>Update</a></li><li class=index><a href=/docs/v1.3/api/upsert/>Upsert</a></li><li class=index><a href=/docs/v1.3/api/serach/>Serach</a></li><li class=index><a href=/docs/v1.3/api/remove/>Remove</a></li><li class=index><a href=/docs/v1.3/api/object/>Object</a></li><li class=index><a href=/docs/v1.3/api/build_proto/>Build Proto</a></li></ul></li><li class=withchild id=cat_Troubleshooting>Troubleshooting<ul></ul></li><li class=withchild id=cat_Contributing>Contributing<ul><li class=index><a href=/docs/v1.3/contributing/contributing-guide/>Contributing Guide</a></li><li class=index><a href=/docs/v1.3/contributing/coding-style/>Coding Style</a></li><li class=index><a href=/docs/v1.3/contributing/unit-test-guideline/>Unit Test Guideline</a></li></ul></li><li class=withchild id=cat_Support>Support<ul><li class=index><a href=/docs/v1.3/support/contacts/>Contacts</a></li></ul></li><li class=withchild id=cat_Release>Release<ul><li class=index><a href=/docs/v1.3/release/changelog/>Changelog</a></li></ul></li></ul></nav></aside><div class=content><div class=markdown id=markdown><h1 id=vald-architecture----omit-in-toc--->Vald Architecture</h1><p>This document describes the high-level architecture design of Vald and explains each component in Vald.</p><h2 id=overview>Overview</h2><p>Vald uses a cloud-native architecture focusing on <a href=https://kubernetes.io/>Kubernetes</a>.
Some components in Vald use Kubernetes API to control the behavior of distributed vector indexes.
Before reading this document, you need to have some understanding of the basic idea of cloud-native architecture and Kubernetes.</p><h3 id=technologies-used-by-vald>Technologies used by Vald</h3><p>Vald is based on the following techologies.</p><ul><li><p><a href=https://kubernetes.io/>Kubernetes</a></p><p>To easily scale and manage Vald, it is used by deploying and running on <a href=https://kubernetes.io/>Kubernetes</a>.
Vald takes all of the advantages of using Kuberenetes.
For more details please read the <a href=#concept>next section</a>.</p></li><li><p><a href=https://helm.sh/>Helm</a></p><p>Helm helps you to deploy and configure Vald.
Vald contains multiple components and configurations.
Helm helps us to manage those manifest and provides a better and easy way to deploy and configure Vald.</p></li><li><p><a href=https://github.com/yahoojapan/NGT>NGT</a></p><p>NGT is one of the core component of Vald.
NGT is a super fast vector search engine used by Vald to guarantee the high performance of Vald.</p></li></ul><h3 id=concept>Concept</h3><p>Here are the concepts of Vald.</p><ul><li><p>Microservice based</p><p>Vald is designed based on the microservice architecture. Vald components are highly decoupled into small components and connected, which increases the overall agility and maintainability of Vald.</p></li><li><p>Containerized</p><p>All components in Vald are containerized, which means you can easily deploy Vald components on any environment.</p></li><li><p>Observability & Real-time monitoring</p><p>All Vald components support Cloud-Native based observability features such as Prometheus and Jaeger exporter.</p></li><li><p>Distributed vector spaces</p><p>All the vector data and indexes are distributed to Vald Agents in the Vald cluster. Whenever you search a vector in Vald cluster, all Vald agents can process parallelly and merge the result by Vald LB Gateway.</p></li><li><p>Kubernetes based</p><p>Vald can integrate with Kubernetes which enables the following features.</p><ul><li><p>Orchestrated</p><p>Kubernetes supports container orchestration. All components in Vald can be managed by Kubernetes automatically.</p></li><li><p>Horizontal scalable</p><p>All Vald components are designed and implemented to be scalable. You can add any node in Kubernetes cluster at any time to scale your Kuberentes cluster, or changing the number of replicas to scale Vald.</p></li><li><p>Auto-healing</p><p>Kubernetes supports the auto-healing feature. The pod can start a new instance automatically whenever the pod is down.</p></li><li><p>Data persistency</p><p>Vald implements backup features. Whenever a Vald Agent is down and kubernetes start a new Vald Agent instance, the data is automatically restored to the new instance to prevent data loss.</p></li><li><p>Easy to manage</p><p>Vald can be deployed easily on your Kubernetes cluster by using Helm charts. The custom resources and custom controllers are useful to manage your Vald cluster.</p></li></ul></li></ul><h2 id=basic-architecture>Basic Architecture</h2><p>Vald is based on microservice architecture, which means Vald is composited by multiple components, you can deploy part of the components to your cluster depending on your needs.
In this section, we will introduce the basic architecture of Vald.</p><img src=/images/v1.3/overview/vald_basic_architecture.svg><p>We will introduce each component and why it is needed in Vald.</p><h3 id=vald-agent>Vald Agent</h3><p>Vald Agent is the core component of Vald, the approximate nearest neighbor search engine, and stores the graph tree construction on memory for indexing the vectors.
Vald Agent uses <a href=https://github.com/yahoojapan/ngt>yahoojapan/NGT</a> as a core library.</p><h3 id=vald-lb-gateway>Vald LB Gateway</h3><p>Vald LB Gateway is a gateway to load balance the user request and forward user request to the Vald Agent based on the resource usage of the Vald Agent and the corresponding cluster node.
In addition, it summarizes the search results from each Vald Agent and returns the final search result to the client.</p><h3 id=vald-discoverer>Vald Discoverer</h3><p>Vald Discoverer provides Vald Agent discovery service to discover active Vald Agent pods in the Kubernetes cluster.
It also retrieves the corresponding Vald Agent resource usage including pod and node resource usage for Vald LB gateway to determine the priority of which Vald Agent handles the user request.</p><h3 id=vald-index-manager>Vald Index Manager</h3><p>Vald Index Manager controls the timing of the indexing of the Vald Agent.
Since the search operation will no work during the Vald Agent index operation is running, thanks to controlling the timing of indexing by Vald Index Manager, index operation of Vald Agent can be triggered and controlled by Vald Index Manager intelligently.</p><p>It retrieves the active Vald Agent pods from the Vald Discoverer and triggers the indexing action on each Vald Agent.</p></div><aside class=current id=current><button class=menu><span class=dot></span></button><nav id=TableOfContents><ul><li><a href=#overview>Overview</a><ul><li><a href=#technologies-used-by-vald>Technologies used by Vald</a></li><li><a href=#concept>Concept</a></li></ul></li><li><a href=#basic-architecture>Basic Architecture</a><ul><li><a href=#vald-agent>Vald Agent</a></li><li><a href=#vald-lb-gateway>Vald LB Gateway</a></li><li><a href=#vald-discoverer>Vald Discoverer</a></li><li><a href=#vald-index-manager>Vald Index Manager</a></li></ul></li></ul></nav></aside></div></div></main><footer class=footer><div class=footer__content><ul class=footer__index><li class=footer__item><a href=/docs/v1.3/overview/about-vald class=footer__link>About<br></a></li><li class=footer__item><a href=/docs/v1.3/tutorial/get-started class=footer__link>Get Started<br></a></li><li class=footer__item><a href=/docs/v1.3/user-guides/sdks class=footer__link>SDKs</a></li><li class=footer__item><a href=/docs/v1.3 class=footer__link>Docs</a></li><li class=footer__item><a href=https://vdaas-vald.medium.com/ target=_blank class=footer__link>Blog<br></a></li></ul><ul class=footer__sns><li class=footer__item><a class="footer__item footer__icon" href=https://x.com/vdaas_vald target=_blank><picture><source srcset=https://vald.vdaas.org//images/logo_x_white.svg media="(prefers-color-scheme: dark)" class=icon__image width=24 height=24><img src=https://vald.vdaas.org//images/logo_x_black.svg alt=x class=icon__image></picture></a></li><li class=footer__item><a class="footer__item footer__icon" href=https://join.slack.com/t/vald-community/shared_invite/zt-db2ky9o4-R_9p2sVp8xRwztVa8gfnPA target=_blank><picture><source srcset=https://vald.vdaas.org//images/logo_slack_white.svg media="(prefers-color-scheme: dark)" class=icon__image width=24 height=24><img src=https://vald.vdaas.org//images/logo_slack_black.svg alt=slack class=icon__image></picture></a></li><li class=footer__item><a class="footer__item footer__icon" href=https://github.com/vdaas/vald target=_blank><picture><source srcset=https://vald.vdaas.org//images/logo_github_white.svg media="(prefers-color-scheme: dark)" class=icon__image width=24 height=24><img src=https://vald.vdaas.org//images/logo_github_black.svg alt=github class=icon__image></picture></a></li></ul></div><p class=footer__copylight>©2019-2021 vald.vdaas.org Vald team</p></footer></body></html>
<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-F9Y0YKG55S"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-F9Y0YKG55S")</script><link rel=canonical href=https://vald.vdaas.org><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=robots content='index, follow'><title>Vald | Continuous Benchmark</title>
<meta name=description content="Vald is high scalable distributed high-speed approximate nearest neighbor search engine" }><meta name=format-detection content="telephone=no"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta property="og:type" content="article"><meta property="og:title" content="Vald | Continuous Benchmark"><meta property="og:description" content="Vald is high scalable distributed high-speed approximate nearest neighbor search engine"><meta property="og:url" content="https://vald.vdaas.org/docs/performance/continuous-benchmark/"><meta property="og:image" content="https://vald.vdaas.org//images/ogp_vald.png"><meta property="og:site_name" content="vald"><meta property="og:locale" content="en_US"><meta property="fb:app_id" content="615732422350002"><meta name=twitter:site content="@vdaas_vald"><meta name=twitter:card content="app"><link rel="shortcut icon" href=https://vald.vdaas.org//favicon.ico><link rel=stylesheet type=text/css href=/css/style.min.css><link rel=stylesheet type=text/css href=/css/header.min.css><link rel=stylesheet type=text/css href=/css/footer.min.css><link rel=stylesheet type=text/css href=/css/main.min.css><script type=text/javascript src=/js/script.min.js defer></script><meta name=viewport content="target-densitydpi=device-dpi,width=device-width,maximum-scale=1,user-scalable=yes"></head><body><header class=header id=header><div class=header__content><nav class=header__nav><a href=https://vald.vdaas.org/ class=header-nav__link><picture class=header-nav__image><source srcset=https://vald.vdaas.org//images/vald_white.svg media="(prefers-color-scheme: dark)"><img src=https://vald.vdaas.org//images/vald_color_1.svg alt>
</picture></a><a class=header-nav__icon id=nav-btn><span class=header-nav__button></span></a><ul class=header__list id=menu><li class=header__item><a href=/docs/overview/about-vald class=header__link>About</a></li><li class=header__item><a href=/docs/tutorial/get-started class=header__link>Get Started</a></li><li class=header__item><a href=/docs/user-guides/sdks class=header__link>SDKs</a></li><li class=header__item><a href=/docs class=header__link>Docs</a></li><li class=header__item><a href=https://vdaas-vald.medium.com/ target=_blank class=header__link>Blog<br></a></li><li class=header__item><details class=header__version id=version_details><summary class=version__current id=current_version>v1.7.12</summary><ul class=version__list><il class=version__item><a href=javascript:void(0) class="version__link version__link--latest">v1.7.12</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.7</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.6</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.5</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.4</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.3</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.2</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.1</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.0</a></il></ul></details></li><li class=header__item><a class=header__git href=https://github.com/vdaas/vald target=_blank><picture class=git__logo><source srcset=https://vald.vdaas.org//images/logo_github_white.svg media="(prefers-color-scheme: dark)" width=18 height=18><img src=https://vald.vdaas.org//images/logo_github_black.svg alt=github width=18 height=18></picture><div class=git__star><p class=git__starnum id=git-star-num></p></div></a></li></ul></nav></div></header><main role=main><div class=single><aside class=page><nav><ul id=list-body><li class=withchild id=cat_Overview>Overview<ul><li class=index><a href=/docs/overview/about-vald/>About Vald</a></li><li class=index><a href=/docs/overview/architecture/>Architecture</a></li><li class=index><a href=/docs/overview/data-flow/>Data Flow</a></li></ul></li><li class=withchild id=cat_Component>Component<ul><li class=index><a href=/docs/overview/component/agent/>Agent</a></li><li class=index><a href=/docs/overview/component/lb-gateway/>Lb Gateway</a></li><li class=index><a href=/docs/overview/component/filter-gateway/>Filter Gateway</a></li><li class=index><a href=/docs/overview/component/discoverer/>Discoverer</a></li><li class=index><a href=/docs/overview/component/index-manager/>Index Manager</a></li><li class=index><a href=/docs/overview/component/mirror-gateway/>Mirror Gateway</a></li></ul></li><li class=withchild id=cat_Tutorial>Tutorial<ul><li class=index><a href=/docs/tutorial/get-started/>Get Started</a></li><li class=index><a href=/docs/tutorial/get-started-with-faiss-agent/>Get Started With Faiss Agent</a></li><li class=index><a href=/docs/tutorial/vald-agent-standalone-on-k8s/>Vald Agent Standalone on K8s</a></li><li class=index><a href=/docs/tutorial/vald-agent-standalone-on-docker/>Vald Agent Standalone on Docker</a></li><li class=index><a href=/docs/tutorial/vald-multicluster-on-k8s/>Vald Multicluster on K8s</a></li></ul></li><li class=withchild id=cat_Usecase>Usecase<ul><li class=index><a href=/docs/usecase/usage-example/>Usage Example</a></li></ul></li><li class=withchild id="cat_User Guides">User Guides<ul><li class=index><a href=/docs/user-guides/configuration/>Configuration</a></li><li class=index><a href=/docs/user-guides/backup-configuration/>Backup Configuration</a></li><li class=index><a href=/docs/user-guides/filtering-configuration/>Filtering Configuration</a></li><li class=index><a href=/docs/user-guides/mirroring-configuration/>Mirroring Configuration</a></li><li class=index><a href=/docs/user-guides/cluster-role-binding/>Cluster Role Binding</a></li><li class=index><a href=/docs/user-guides/deployment/>Deployment</a></li><li class=index><a href=/docs/user-guides/operations/>Operations</a></li><li class=index><a href=/docs/user-guides/upgrade-cluster/>Upgrade Cluster</a></li><li class=index><a href=/docs/user-guides/capacity-planning/>Capacity Planning</a></li><li class=index><a href=/docs/user-guides/client-api-config/>Client Api Config</a></li><li class=index><a href=/docs/user-guides/observability-configuration/>Observability Configuration</a></li><li class=index><a href=/docs/user-guides/network-policy/>Network Policy</a></li><li class=index><a href=/docs/user-guides/index-correction/>Index Correction</a></li><li class=index><a href=/docs/user-guides/sdks/>Sdks</a></li></ul></li><li class=withchild id=cat_Performance>Performance<ul><li class=index><a href=/docs/performance/benchmark/>Benchmark</a></li><li class=index><a href=/docs/performance/loadtest/>Loadtest</a></li><li class=view><a href=/docs/performance/continuous-benchmark/>Continuous Benchmark</a></li><li class=index><a href=/docs/performance/tuning-search-performance/>Tuning Search Performance</a></li></ul></li><li class=withchild id=cat_Api>API<ul><li class=index><a href=/docs/api/insert/>Insert</a></li><li class=index><a href=/docs/api/update/>Update</a></li><li class=index><a href=/docs/api/upsert/>Upsert</a></li><li class=index><a href=/docs/api/search/>Search</a></li><li class=index><a href=/docs/api/remove/>Remove</a></li><li class=index><a href=/docs/api/object/>Object</a></li><li class=index><a href=/docs/api/filter-gateway/>Filter Gateway</a></li><li class=index><a href=/docs/api/mirror-gateway/>Mirror Gateway</a></li><li class=index><a href=/docs/api/status/>Status</a></li><li class=index><a href=/docs/api/build_proto/>Build</a></li></ul></li><li class=withchild id=cat_Troubleshooting>Troubleshooting<ul><li class=index><a href=/docs/troubleshooting/client-side/>Client Side</a></li><li class=index><a href=/docs/troubleshooting/provisioning/>Provisioning</a></li><li class=index><a href=/docs/troubleshooting/mirror-gateway/>Mirror Gateway</a></li></ul></li><li class=withchild id=cat_Contributing>Contributing<ul><li class=index><a href=/docs/contributing/contributing-guide/>Contributing Guide</a></li><li class=index><a href=/docs/contributing/development/>Development</a></li><li class=index><a href=/docs/contributing/coding-style/>Coding Style</a></li><li class=index><a href=/docs/contributing/unit-test-guideline/>Unit Test Guideline</a></li></ul></li><li class=withchild id=cat_Support>Support<ul><li class=index><a href=/docs/support/contacts/>Contacts</a></li><li class=index><a href=/docs/support/faq/>Faq</a></li></ul></li><li class=withchild id=cat_Release>Release<ul><li class=index><a href=/docs/release/changelog/>Changelog</a></li></ul></li></ul></nav></aside><div class=content><div class=markdown id=markdown><h1 id=continuous-benchmark-tool>Continuous Benchmark Tool</h1><h2 id=what-is-the-continuous-benchmark-tool>What is the Continuous Benchmark Tool?</h2><p>Continuous Benchmark Tool allows you to get benchmark of Vald cluster in 24/7.</p><p>Assumed use case is:</p><ul><li>Verification with workload close to the production environment</li><li>Verification before service installation when Vald version up</li></ul><h2 id=architecture>Architecture</h2><p>Continuous Benchmark Tool has following 2 components:</p><ul><li>Benchmark Operator: Manages benchmark jobs</li><li>Benchmark Job: Executes CRUDs request to the target Vald cluster</li></ul><h2 id=benchmark-component-and-its-feature>Benchmark component and its feature</h2><h3 id=benchmark-operator>Benchmark Operator</h3><ul><li>Manages benchmark jobs according to applied manifest.</li><li>Apply method:<ul><li>Scenario method: one manifest with multiple benchmark jobs</li><li>Job method: one manifest with one benchmark job</li></ul></li></ul><h3 id=benchmark-job>Benchmark Job</h3><ul><li>Executes CRUD request to the target Vald cluster based on defined config.</li><li>Execute steps are:<ol><li>Load dataset (valid only for HDF5 format )</li><li>Execute request with load dataset</li></ol></li></ul><h2 id=benchmark-crd>Benchmark CRD</h2><p>Benchmark workload can be set by applying the Kubernetes Custom Resources(CRDs), <code>ValdBenchmarkScenarioResource</code> or <code>ValdBenchmarkJobResource</code>.
Benchmark Operator manages benchmark job according to the applied manifest.</p><h3 id=valdbenchmarkjob>ValdBenchmarkJob</h3><p><a href=https://github.com/vdaas/vald/blob/main/charts/vald-benchmark-operator/crds/valdbenchmarkjob.yaml><code>ValdBenchmarkJob</code></a> is used for executing single benchmark job.</p><p>And, Benchmark Operator also applies it to the Kubernetes cluster based on <code>ValdBenchmarkScenarioResource</code>.</p><p><strong>main properties</strong></p><table><thead><tr><th style=text-align:left>Name</th><th style=text-align:left>mandatory</th><th style=text-align:left>Description</th><th style=text-align:left>type</th><th style=text-align:left>sample</th></tr></thead><tbody><tr><td style=text-align:left>target</td><td style=text-align:left>*</td><td style=text-align:left>target Vald cluster</td><td style=text-align:left>object</td><td style=text-align:left>ref: <a href=#target-prop>target</a></td></tr><tr><td style=text-align:left>dataset</td><td style=text-align:left>*</td><td style=text-align:left>dataset information</td><td style=text-align:left>object</td><td style=text-align:left>ref: <a href=#dataset-prop>dataset</a></td></tr><tr><td style=text-align:left>job_type</td><td style=text-align:left>*</td><td style=text-align:left>execute job type</td><td style=text-align:left>string enum: [insert, update, upsert, remove, search, getobject, exists]</td><td style=text-align:left>search</td></tr><tr><td style=text-align:left>repetition</td><td style=text-align:left></td><td style=text-align:left>the number of job repetitions<br>default: <code>1</code></td><td style=text-align:left>integer</td><td style=text-align:left>1</td></tr><tr><td style=text-align:left>replica</td><td style=text-align:left></td><td style=text-align:left>the number of job concurrent job executions<br>default: <code>1</code></td><td style=text-align:left>integer</td><td style=text-align:left>2</td></tr><tr><td style=text-align:left>rps</td><td style=text-align:left></td><td style=text-align:left>designed request per sec to the target cluster<br>default: <code>1000</code></td><td style=text-align:left>integer</td><td style=text-align:left>1000</td></tr><tr><td style=text-align:left>concurrency_limit</td><td style=text-align:left></td><td style=text-align:left>goroutine count limit for rps adjustment<br>default: <code>200</code></td><td style=text-align:left>integer</td><td style=text-align:left>20</td></tr><tr><td style=text-align:left>ttl_seconds_after_finished</td><td style=text-align:left></td><td style=text-align:left>time until deletion of Pod after job end<br>default: <code>600</code></td><td style=text-align:left>integer</td><td style=text-align:left>120</td></tr><tr><td style=text-align:left>insert_config</td><td style=text-align:left></td><td style=text-align:left>request config for insert job</td><td style=text-align:left>object</td><td style=text-align:left>ref: <a href=#insert-cfg-props>config</a></td></tr><tr><td style=text-align:left>update_config</td><td style=text-align:left></td><td style=text-align:left>request config for update job</td><td style=text-align:left>object</td><td style=text-align:left>ref: <a href=#update-cfg-props>config</a></td></tr><tr><td style=text-align:left>upsert_config</td><td style=text-align:left></td><td style=text-align:left>request config for upsert job</td><td style=text-align:left>object</td><td style=text-align:left>ref: <a href=#upsert-cfg-props>config</a></td></tr><tr><td style=text-align:left>search_config</td><td style=text-align:left></td><td style=text-align:left>request config for search job</td><td style=text-align:left>object</td><td style=text-align:left>ref: <a href=#search-cfg-props>config</a></td></tr><tr><td style=text-align:left>remove_config</td><td style=text-align:left></td><td style=text-align:left>request config for remove job</td><td style=text-align:left>object</td><td style=text-align:left>ref: <a href=#remove-cfg-props>config</a></td></tr><tr><td style=text-align:left>object_config</td><td style=text-align:left></td><td style=text-align:left>request config for object job</td><td style=text-align:left>object</td><td style=text-align:left>ref: <a href=#object-cfg-props>config</a></td></tr><tr><td style=text-align:left>client_config</td><td style=text-align:left></td><td style=text-align:left>gRPC client config for running benchmark job<br>Tune if can not getting the expected performance with default config.</td><td style=text-align:left>object</td><td style=text-align:left>ref: <a href=https://github.com/vdaas/vald/blob/main/charts/vald/README>defaults.grpc</a></td></tr><tr><td style=text-align:left>server_config</td><td style=text-align:left></td><td style=text-align:left>server config for benchmark job pod<br>Tune if can not getting the expected performance with default config.</td><td style=text-align:left>object</td><td style=text-align:left>ref: <a href=https://github.com/vdaas/vald/blob/main/charts/vald/README>defaults.server_config</a></td></tr></tbody></table><a id=target-prop><p><strong>target</strong></p><ul><li>target Vald cluster information</li><li>type: object</li></ul><table><thead><tr><th style=text-align:left>property</th><th style=text-align:left>mandatory</th><th style=text-align:left>description</th><th style=text-align:left>type</th><th style=text-align:left>sample</th></tr></thead><tbody><tr><td style=text-align:left>host</td><td style=text-align:left>*</td><td style=text-align:left>target cluster&rsquo;s host</td><td style=text-align:left>string</td><td style=text-align:left>localhost</td></tr><tr><td style=text-align:left>port</td><td style=text-align:left>*</td><td style=text-align:left>target cluster&rsquo;s port</td><td style=text-align:left>integer</td><td style=text-align:left>8081</td></tr></tbody></table><a id=dataset-prop><p><strong>dataset</strong></p><ul><li>dataset which is used for executing job operation</li><li>type: object</li></ul><table><thead><tr><th style=text-align:left>property</th><th style=text-align:left>mandatory</th><th style=text-align:left>description</th><th style=text-align:left>type</th><th style=text-align:left>sample</th></tr></thead><tbody><tr><td style=text-align:left>name</td><td style=text-align:left>*</td><td style=text-align:left>dataset name</td><td style=text-align:left>string enum: [fashion-mnist, original]</td><td style=text-align:left>fashion-mnist</td></tr><tr><td style=text-align:left>group</td><td style=text-align:left>*</td><td style=text-align:left>group name</td><td style=text-align:left>string enum: [train, test, neighbors]</td><td style=text-align:left>train</td></tr><tr><td style=text-align:left>indexes</td><td style=text-align:left>*</td><td style=text-align:left>amount of index size</td><td style=text-align:left>integer</td><td style=text-align:left>1000000</td></tr><tr><td style=text-align:left>range</td><td style=text-align:left>*</td><td style=text-align:left>range of indexes to be used (if there are many indexes, the range will be corrected on the job side)</td><td style=text-align:left>object</td><td style=text-align:left>-</td></tr><tr><td style=text-align:left>range.start</td><td style=text-align:left>*</td><td style=text-align:left>start of range</td><td style=text-align:left>integer</td><td style=text-align:left>1</td></tr><tr><td style=text-align:left>range.end</td><td style=text-align:left>*</td><td style=text-align:left>end of range</td><td style=text-align:left>integer</td><td style=text-align:left>1000000</td></tr><tr><td style=text-align:left>url</td><td style=text-align:left></td><td style=text-align:left>the dataset url. It should be set when set <code>name</code> as <code>original</code></td><td style=text-align:left>string</td><td style=text-align:left></td></tr></tbody></table><a id=insert-cfg-props><p><strong>insert_config</strong></p><ul><li>rpc config for insert request</li><li>type: object</li></ul><table><thead><tr><th style=text-align:left>property</th><th style=text-align:left>mandatory</th><th style=text-align:left>description</th><th style=text-align:left>type</th><th style=text-align:left>sample</th></tr></thead><tbody><tr><td style=text-align:left>skip_strict_exist_check</td><td style=text-align:left></td><td style=text-align:left>Check whether the same vector is already inserted or not.<br>The ID should be unique if the value is <code>true</code>.</td><td style=text-align:left>bool</td><td style=text-align:left>false</td></tr><tr><td style=text-align:left>timestamp</td><td style=text-align:left></td><td style=text-align:left>The timestamp of the vector inserted.<br>If it is N/A, the current time will be used.</td><td style=text-align:left>string</td><td style=text-align:left>1707272658</td></tr></tbody></table><a id=update-cfg-props><p><strong>update_config</strong></p><ul><li>rpc config for update request</li><li>type: object</li></ul><table><thead><tr><th style=text-align:left>property</th><th style=text-align:left>mandatory</th><th style=text-align:left>description</th><th style=text-align:left>type</th><th style=text-align:left>sample</th></tr></thead><tbody><tr><td style=text-align:left>skip_strict_exist_check</td><td style=text-align:left></td><td style=text-align:left>Check whether the same vector is already inserted or not.<br>The ID should be unique if the value is <code>true</code>.</td><td style=text-align:left>bool</td><td style=text-align:left>false</td></tr><tr><td style=text-align:left>timestamp</td><td style=text-align:left></td><td style=text-align:left>The timestamp of the vector inserted.<br>If it is N/A, the current time will be used.</td><td style=text-align:left>string</td><td style=text-align:left>1707272658</td></tr><tr><td style=text-align:left>disable_balanced_update</td><td style=text-align:left></td><td style=text-align:left>A flag to disable balanced update (split remove -> insert operation) during update operation.</td><td style=text-align:left>bool</td><td style=text-align:left>false</td></tr></tbody></table><a id=upsert-cfg-props><p><strong>upsert_config</strong></p><ul><li>rpc config for upsert request</li><li>type: object</li></ul><table><thead><tr><th style=text-align:left>property</th><th style=text-align:left>mandatory</th><th style=text-align:left>description</th><th style=text-align:left>type</th><th style=text-align:left>sample</th></tr></thead><tbody><tr><td style=text-align:left>skip_strict_exist_check</td><td style=text-align:left></td><td style=text-align:left>Check whether the same vector is already inserted or not.<br>The ID should be unique if the value is <code>true</code>.</td><td style=text-align:left>bool</td><td style=text-align:left>false</td></tr><tr><td style=text-align:left>timestamp</td><td style=text-align:left></td><td style=text-align:left>The timestamp of the vector inserted.<br>If it is N/A, the current time will be used.</td><td style=text-align:left>string</td><td style=text-align:left>1707272658</td></tr><tr><td style=text-align:left>disable_balanced_update</td><td style=text-align:left></td><td style=text-align:left>A flag to disable balanced update (split remove -> insert operation) during update operation.</td><td style=text-align:left>bool</td><td style=text-align:left>false</td></tr></tbody></table><a id=search-cfg-props><p><strong>upsert_config</strong></p><ul><li>rpc config for search request</li><li>type: object</li></ul><table><thead><tr><th style=text-align:left>property</th><th style=text-align:left>mandatory</th><th style=text-align:left>description</th><th style=text-align:left>type</th><th style=text-align:left>sample</th></tr></thead><tbody><tr><td style=text-align:left>radius</td><td style=text-align:left></td><td style=text-align:left>The search radius.<br>default: <code>-1</code></td><td style=text-align:left>number</td><td style=text-align:left>-1</td></tr><tr><td style=text-align:left>epsilon</td><td style=text-align:left></td><td style=text-align:left>The search coefficient.<br>default: <code>0.05</code></td><td style=text-align:left>number</td><td style=text-align:left>0.05</td></tr><tr><td style=text-align:left>num</td><td style=text-align:left>*</td><td style=text-align:left>The maximum number of results to be returned.</td><td style=text-align:left>integer</td><td style=text-align:left>10</td></tr><tr><td style=text-align:left>min_num</td><td style=text-align:left></td><td style=text-align:left>The minimum number of results to be returned.</td><td style=text-align:left>integer</td><td style=text-align:left>5</td></tr><tr><td style=text-align:left>timeout</td><td style=text-align:left></td><td style=text-align:left>Search timeout in nanoseconds<br>default: <code>10s</code></td><td style=text-align:left>string</td><td style=text-align:left>3s</td></tr><tr><td style=text-align:left>enable_linear_search</td><td style=text-align:left></td><td style=text-align:left>A flag to enable linear search operation for estimating search recall.<br>If it is <code>true</code>, search operation with linear operation will execute.</td><td style=text-align:left>bool</td><td style=text-align:left>false</td></tr><tr><td style=text-align:left>aggregation_algorithm</td><td style=text-align:left></td><td style=text-align:left>The search aggregation algorithm option.<br>default: <code>Unknown</code></td><td style=text-align:left>string enum: [&ldquo;Unknown&rdquo;, &ldquo;ConcurrentQueue&rdquo;, &ldquo;SortSlice&rdquo;, &ldquo;SortPoolSlice&rdquo;, &ldquo;PairingHeap&rdquo;]</td><td style=text-align:left></td></tr></tbody></table><a id=remove-cfg-props><p><strong>remove_config</strong></p><ul><li>rpc config for remove request</li><li>type: object</li></ul><table><thead><tr><th style=text-align:left>property</th><th style=text-align:left>mandatory</th><th style=text-align:left>description</th><th style=text-align:left>type</th><th style=text-align:left>sample</th></tr></thead><tbody><tr><td style=text-align:left>skip_strict_exist_check</td><td style=text-align:left></td><td style=text-align:left>Check whether the same vector is already inserted or not.<br>The ID should be unique if the value is <code>true</code>.</td><td style=text-align:left>bool</td><td style=text-align:left>false</td></tr><tr><td style=text-align:left>timestamp</td><td style=text-align:left></td><td style=text-align:left>The timestamp of the vector inserted.<br>If it is N/A, the current time will be used.</td><td style=text-align:left>string</td><td style=text-align:left>1707272658</td></tr></tbody></table><a id=object-cfg-props><p><strong>object_config</strong></p><ul><li>rpc config for get object request</li><li>type: object</li></ul><table><thead><tr><th style=text-align:left>property</th><th style=text-align:left>mandatory</th><th style=text-align:left>description</th><th style=text-align:left>type</th><th style=text-align:left>sample</th></tr></thead><tbody><tr><td style=text-align:left>filter_config.targets</td><td style=text-align:left></td><td style=text-align:left>filter target host and port for bypassing filter component.</td><td style=text-align:left>[]object</td><td style=text-align:left></td></tr></tbody></table><h3 id=valdbenchmarkscenario>ValdBenchmarkScenario</h3><p><a href=https://github.com/vdaas/vald/blob/main/charts/vald-benchmark-operator/crds/valdbenchmarkscenario.yaml><code>ValdBenchmarkScenario</code></a> is used for executing single or multiple benchmark job.</p><p>Benchmark Operator decomposes manifest and creates benchmark resources one by one.
The <code>target</code> and <code>dataset</code> property are the global config for scenario, they can be overwritten when each job has own config.</p><p><strong>main properties</strong></p><table><thead><tr><th style=text-align:left>property</th><th style=text-align:left>mandatory</th><th style=text-align:left>description</th><th style=text-align:left>type</th><th style=text-align:left>sample</th></tr></thead><tbody><tr><td style=text-align:left>target</td><td style=text-align:left>*</td><td style=text-align:left>target Vald cluster information<br>It will be overwritten when each job has own config</td><td style=text-align:left>object</td><td style=text-align:left>ref: <a href=#target-prop>target</a></td></tr><tr><td style=text-align:left>dataset</td><td style=text-align:left>*</td><td style=text-align:left>dataset information<br>It will be overwritten when each job has own config</td><td style=text-align:left>object</td><td style=text-align:left>ref: <a href=#dataset-prop>dataset</a></td></tr><tr><td style=text-align:left>jobs</td><td style=text-align:left>*</td><td style=text-align:left>benchmark job config<br>The jobs written above will be executed in order.</td><td style=text-align:left>object</td><td style=text-align:left>ref: <a href=#valdbenchmarkjob>benchmark job</a></td></tr></tbody></table><h2 id=deploy-benchmark-operator>Deploy Benchmark Operator</h2><p>Continuous benchmark operator can be applied with <code>Helm</code> same as Vald cluster.</p><p>It requires <code>ValdBenchmarkOperatorRelease</code> for deploying <code>vald-benchmark-operator</code>.</p><p>It is not must to apply, so please edit and apply as necessary.</p><details><summary>Sample ValdBenchmarkOperatorRelease YAML</summary><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># @schema {&#34;name&#34;: &#34;name&#34;, &#34;type&#34;: &#34;string&#34;}</span>
</span></span><span style=display:flex><span><span style=color:#75715e># name -- name of the deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>vald-benchmark-operator</span>
</span></span><span style=display:flex><span><span style=color:#75715e># @schema {&#34;name&#34;: &#34;time_zone&#34;, &#34;type&#34;: &#34;string&#34;}</span>
</span></span><span style=display:flex><span><span style=color:#75715e># time_zone -- time_zone</span>
</span></span><span style=display:flex><span><span style=color:#f92672>time_zone</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># @schema {&#34;name&#34;: &#34;image&#34;, &#34;type&#34;: &#34;object&#34;}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>image</span>:
</span></span><span style=display:flex><span>  <span style=color:#75715e># @schema {&#34;name&#34;: &#34;image.repository&#34;, &#34;type&#34;: &#34;string&#34;}</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># image.repository -- image repository</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>repository</span>: <span style=color:#ae81ff>vdaas/vald-benchmark-operator</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># @schema {&#34;name&#34;: &#34;image.tag&#34;, &#34;type&#34;: &#34;string&#34;}</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># image.tag -- image tag</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>tag</span>: <span style=color:#ae81ff>v1.7.5</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># @schema {&#34;name&#34;: &#34;image.pullPolicy&#34;, &#34;type&#34;: &#34;string&#34;, &#34;enum&#34;: [&#34;Always&#34;, &#34;Never&#34;, &#34;IfNotPresent&#34;]}</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># image.pullPolicy -- image pull policy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>pullPolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span><span style=color:#75715e># @schema {&#34;name&#34;: &#34;job_image&#34;, &#34;type&#34;: &#34;object&#34;}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>job_image</span>:
</span></span><span style=display:flex><span>  <span style=color:#75715e># @schema {&#34;name&#34;: &#34;job_image.repository&#34;, &#34;type&#34;: &#34;string&#34;}</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># image.repository -- job image repository</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>repository</span>: <span style=color:#ae81ff>vdaas/vald-benchmark-job</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># @schema {&#34;name&#34;: &#34;job_image.tag&#34;, &#34;type&#34;: &#34;string&#34;}</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># image.tag -- image tag for job docker image</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>tag</span>: <span style=color:#ae81ff>v1.7.5</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># @schema {&#34;name&#34;: &#34;job_image.pullPolicy&#34;, &#34;type&#34;: &#34;string&#34;, &#34;enum&#34;: [&#34;Always&#34;, &#34;Never&#34;, &#34;IfNotPresent&#34;]}</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># image.pullPolicy -- image pull policy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>pullPolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span><span style=color:#75715e># @schema {&#34;name&#34;: &#34;resources&#34;, &#34;type&#34;: &#34;object&#34;}</span>
</span></span><span style=display:flex><span><span style=color:#75715e># resources -- kubernetes resources of pod</span>
</span></span><span style=display:flex><span><span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>  <span style=color:#75715e># @schema {&#34;name&#34;: &#34;resources.limits&#34;, &#34;type&#34;: &#34;object&#34;}</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>limits</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>cpu</span>: <span style=color:#ae81ff>300m</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>300Mi</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># @schema {&#34;name&#34;: &#34;resources.requests&#34;, &#34;type&#34;: &#34;object&#34;}</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>requests</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>cpu</span>: <span style=color:#ae81ff>200m</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>200Mi</span>
</span></span><span style=display:flex><span><span style=color:#75715e># @schema {&#34;name&#34;: &#34;logging&#34;, &#34;type&#34;: &#34;object&#34;}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>logging</span>:
</span></span><span style=display:flex><span>  <span style=color:#75715e># @schema {&#34;name&#34;: &#34;logging.logger&#34;, &#34;type&#34;: &#34;string&#34;, &#34;enum&#34;: [&#34;glg&#34;, &#34;zap&#34;]}</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># logging.logger -- logger name.</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>logger</span>: <span style=color:#ae81ff>glg</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># @schema {&#34;name&#34;: &#34;logging.level&#34;, &#34;type&#34;: &#34;string&#34;, &#34;enum&#34;: [&#34;debug&#34;, &#34;info&#34;, &#34;warn&#34;, &#34;error&#34;, &#34;fatal&#34;]}</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># logging.level -- logging level.</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>level</span>: <span style=color:#ae81ff>debug</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># @schema {&#34;name&#34;: &#34;logging.format&#34;, &#34;type&#34;: &#34;string&#34;, &#34;enum&#34;: [&#34;raw&#34;, &#34;json&#34;]}</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># logging.format -- logging format.</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>format</span>: <span style=color:#ae81ff>raw</span>
</span></span></code></pre></div></details><p>For more details of the configuration of <code>vald-benchmark-operator-release</code>, please refer to <a href=https://github.com/vdaas/vald/blob/main/charts/vald-benchmark-operator/values.yaml>here</a></p><ol><li><p>Add Vald repo into the helm repo</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm repo add vald https://vdaas.vald.org
</span></span></code></pre></div></li><li><p>Deploy <code>vald-benchmark-operator-release</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm install vald-benchmark-operator-release vald/vald-benchmark-operator
</span></span></code></pre></div></li><li><p>Apply <code>vbor.yaml</code> (optional)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f vbor.yaml
</span></span></code></pre></div></li></ol><h2 id=running-continuous-benchmarks>Running Continuous Benchmarks</h2><p>After deploy the benchmark operator, you can execute continuous benchmark by applying <code>ValdBenchmarkScenarioRelease</code> or <code>ValdBenchmarkJobRelease</code>.</p><p>Please configure designed benchmark and apply by <code>kubectl</code> command.</p><p>The sample manifests are <a href=https://github.com/vdaas/vald/tree/main/example/helm/benchmark>here</a>.</p><h2>See also</h2><div class=cardlist><a href=/docs/performance/benchmark/ class=cardlist__card><p class=card__title>Benchmark</p><p class=card__text>Measuring performance of Vald cluster</p></a><a href=/docs/performance/loadtest/ class=cardlist__card><p class=card__title>Loadtest</p><p class=card__text>Shows how to perform load test in the Vald cluster</p></a><a href=/docs/performance/tuning-search-performance/ class=cardlist__card><p class=card__title>Tuning Search Performance</p><p class=card__text></p></a></div></div><aside class=current id=current><button class=menu><span class=dot></span></button><nav id=TableOfContents><ul><li><a href=#what-is-the-continuous-benchmark-tool>What is the Continuous Benchmark Tool?</a></li><li><a href=#architecture>Architecture</a></li><li><a href=#benchmark-component-and-its-feature>Benchmark component and its feature</a><ul><li><a href=#benchmark-operator>Benchmark Operator</a></li><li><a href=#benchmark-job>Benchmark Job</a></li></ul></li><li><a href=#benchmark-crd>Benchmark CRD</a><ul><li><a href=#valdbenchmarkjob>ValdBenchmarkJob</a></li><li><a href=#valdbenchmarkscenario>ValdBenchmarkScenario</a></li></ul></li><li><a href=#deploy-benchmark-operator>Deploy Benchmark Operator</a></li><li><a href=#running-continuous-benchmarks>Running Continuous Benchmarks</a></li></ul></nav></aside></div></div></main><footer class=footer><div class=footer__content><ul class=footer__index><li class=footer__item><a href=/docs/overview/about-vald class=footer__link>About<br></a></li><li class=footer__item><a href=/docs/tutorial/get-started class=footer__link>Get Started<br></a></li><li class=footer__item><a href=/docs/user-guides/sdks class=footer__link>SDKs</a></li><li class=footer__item><a href=/docs class=footer__link>Docs</a></li><li class=footer__item><a href=https://vdaas-vald.medium.com/ target=_blank class=footer__link>Blog<br></a></li></ul><ul class=footer__sns><li class=footer__item><a class="footer__item footer__icon" href=https://twitter.com/vdaas_vald target=_blank><picture><source srcset=https://vald.vdaas.org//images/logo_x_white.svg media="(prefers-color-scheme: dark)" class=icon__image width=24 height=24><img src=https://vald.vdaas.org//images/logo_x_black.svg alt=x class=icon__image></picture></a></li><li class=footer__item><a class="footer__item footer__icon" href=https://join.slack.com/t/vald-community/shared_invite/zt-db2ky9o4-R_9p2sVp8xRwztVa8gfnPA target=_blank><picture><source srcset=https://vald.vdaas.org//images/logo_slack_white.svg media="(prefers-color-scheme: dark)" class=icon__image width=24 height=24><img src=https://vald.vdaas.org//images/logo_slack_black.svg alt=slack class=icon__image></picture></a></li><li class=footer__item><a class="footer__item footer__icon" href=https://github.com/vdaas/vald target=_blank><picture><source srcset=https://vald.vdaas.org//images/logo_github_white.svg media="(prefers-color-scheme: dark)" class=icon__image width=24 height=24><img src=https://vald.vdaas.org//images/logo_github_black.svg alt=github class=icon__image></picture></a></li></ul></div><p class=footer__copylight>Â©2019-2024 vald.vdaas.org Vald team</p></footer></body></html>
<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-F9Y0YKG55S"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-F9Y0YKG55S")</script><link rel=canonical href=https://vald.vdaas.org><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=robots content="index, follow"><title>Vald | Search Config</title>
<meta name=description content="Vald is high scalable distributed high-speed approximate nearest neighbor search engine" }><meta name=format-detection content="telephone=no"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta property="og:type" content="article"><meta property="og:title" content="Vald | Search Config"><meta property="og:description" content="Vald is high scalable distributed high-speed approximate nearest neighbor search engine"><meta property="og:url" content="https://vald.vdaas.org/docs/v1.5/user-guides/search-config/"><meta property="og:image" content="https://vald.vdaas.org/images/ogp_vald.png"><meta property="og:site_name" content="vald"><meta property="og:locale" content="en_US"><meta property="fb:app_id" content="615732422350002"><meta name=twitter:site content="@vdaas_vald"><meta name=twitter:card content="app"><link rel="shortcut icon" href=https://vald.vdaas.org/favicon.ico><link rel=stylesheet type=text/css href=/css/style.min.css><link rel=stylesheet type=text/css href=/css/header.min.css><link rel=stylesheet type=text/css href=/css/footer.min.css><link rel=stylesheet type=text/css href=/css/main.min.css><script type=text/javascript src=/js/script.min.js defer></script><meta name=viewport content="target-densitydpi=device-dpi,width=device-width,maximum-scale=1,user-scalable=yes"></head><body><header class=header id=header><div class=header__content><nav class=header__nav><a href=https://vald.vdaas.org class=header-nav__link><picture class=header-nav__image><source srcset=https://vald.vdaas.org/images/vald_white.svg media="(prefers-color-scheme: dark)"><img src=https://vald.vdaas.org/images/vald_color_1.svg alt>
</picture></a><a class=header-nav__icon id=nav-btn><span class=header-nav__button></span></a><ul class=header__list id=menu><li class=header__item><a href=/docs/v1.5/overview/about-vald class=header__link>About</a></li><li class=header__item><a href=/docs/v1.5/tutorial/get-started class=header__link>Get Started</a></li><li class=header__item><a href=/docs/v1.5/user-guides/sdks class=header__link>SDKs</a></li><li class=header__item><a href=/docs/v1.5 class=header__link>Docs</a></li><li class=header__item><a href=https://vdaas-vald.medium.com/ target=_blank class=header__link>Blog<br></a></li><li class=header__item><details class=header__version id=version_details><summary class=version__current id=current_version>v1.5</summary><ul class=version__list><il class=version__item><a href=javascript:void(0) class="version__link version__link--latest">v1.7.10</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.7</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.6</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.5</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.4</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.3</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.2</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.1</a></il>
<il class=version__item><a href=javascript:void(0) class=version__link>v1.0</a></il></ul></details></li><li class=header__item><a class=header__git href=https://github.com/vdaas/vald target=_blank><picture class=git__logo><source srcset=https://vald.vdaas.org/images/logo_github_white.svg media="(prefers-color-scheme: dark)" width=18 height=18><img src=https://vald.vdaas.org/images/logo_github_black.svg alt=github width=18 height=18></picture><div class=git__star><p class=git__starnum id=git-star-num></p></div></a></li></ul></nav></div></header><main role=main><div class=single><aside class=page><nav><ul id=list-body><li class=withchild id=cat_Overview>Overview<ul><li class=index><a href=/docs/v1.5/overview/about-vald/>About Vald</a></li><li class=index><a href=/docs/v1.5/overview/architecture/>Architecture</a></li><li class=index><a href=/docs/v1.5/overview/data-flow/>Data Flow</a></li></ul></li><li class=withchild id=cat_Component>Component<ul><li class=index><a href=/docs/v1.5/overview/component/agent/>Agent</a></li><li class=index><a href=/docs/v1.5/overview/component/lb-gateway/>LB Gateway</a></li><li class=index><a href=/docs/v1.5/overview/component/filter-gateway/>Filter Gateway</a></li><li class=index><a href=/docs/v1.5/overview/component/discoverer/>Discoverer</a></li><li class=index><a href=/docs/v1.5/overview/component/index-manager/>Index Manager</a></li></ul></li><li class=withchild id=cat_Tutorial>Tutorial<ul><li class=index><a href=/docs/v1.5/tutorial/get-started/>Get Started</a></li><li class=index><a href=/docs/v1.5/tutorial/vald-agent-standalone-on-k8s/>Vald Agent Standalone on K8s</a></li><li class=index><a href=/docs/v1.5/tutorial/vald-agent-standalone-on-docker/>Vald Agent Standalone on Docker</a></li></ul></li><li class=withchild id=cat_Usecase>Usecase<ul><li class=index><a href=/docs/v1.5/usecase/usage-example/>Usage Example</a></li></ul></li><li class=withchild id="cat_User Guides">User Guides<ul><li class=index><a href=/docs/v1.5/user-guides/configuration/>Configuration</a></li><li class=index><a href=/docs/v1.5/user-guides/filtering-configuration/>Filtering Configuration</a></li><li class=index><a href=/docs/v1.5/user-guides/deployment/>Deployment</a></li><li class=index><a href=/docs/v1.5/user-guides/operations/>Operations</a></li><li class=index><a href=/docs/v1.5/user-guides/sdks/>Sdks</a></li><li class=index><a href=/docs/v1.5/user-guides/capacity-planning/>Capacity Planning</a></li><li class=view><a href=/docs/v1.5/user-guides/search-config/>Search Config</a></li></ul></li><li class=withchild id=cat_Performance>Performance<ul><li class=index><a href=/docs/v1.5/performance/benchmark/>Benchmark</a></li><li class=index><a href=/docs/v1.5/performance/loadtest/>Loadtest</a></li></ul></li><li class=withchild id=cat_Api>API<ul><li class=index><a href=/docs/v1.5/api/insert/>Insert</a></li><li class=index><a href=/docs/v1.5/api/update/>Update</a></li><li class=index><a href=/docs/v1.5/api/upsert/>Upsert</a></li><li class=index><a href=/docs/v1.5/api/search/>Search</a></li><li class=index><a href=/docs/v1.5/api/remove/>Remove</a></li><li class=index><a href=/docs/v1.5/api/object/>Object</a></li><li class=index><a href=/docs/v1.5/api/build_proto/>Build Proto</a></li><li class=index><a href=/docs/v1.5/api/status/>Status Code</a></li></ul></li><li class=withchild id=cat_Troubleshooting>Troubleshooting<ul><li class=index><a href=/docs/v1.5/troubleshooting/provisioning/>Provisioning</a></li><li class=index><a href=/docs/v1.5/troubleshooting/client-side/>Client Side</a></li></ul></li><li class=withchild id=cat_Contributing>Contributing<ul><li class=index><a href=/docs/v1.5/contributing/contributing-guide/>Contributing Guide</a></li><li class=index><a href=/docs/v1.5/contributing/coding-style/>Coding Style</a></li><li class=index><a href=/docs/v1.5/contributing/unit-test-guideline/>Unit Test Guideline</a></li></ul></li><li class=withchild id=cat_Support>Support<ul><li class=index><a href=/docs/v1.5/support/contacts/>Contacts</a></li><li class=index><a href=/docs/v1.5/support/faq/>FAQ</a></li></ul></li><li class=withchild id=cat_Release>Release<ul><li class=index><a href=/docs/v1.5/release/changelog/>Changelog</a></li></ul></li></ul></nav></aside><div class=content><div class=markdown id=markdown><h1 id=search-config>Search Config</h1><h2 id=vald-search-service>Vald Search Service</h2><p>Vald provides four types of search services.</p><ol><li><p>Search</p><ul><li><code>Search</code> is the <code>ANN(Approximate Nearest Neighbor)</code> search with query vector.
It is a fast search even though the vector consists large dimension.
The search duration is quick but less accurate than <code>LinearSearch</code>.
The search algorithm depends on each core algorithm.</li></ul></li><li><p>SearchById</p><ul><li><code>SearchById</code> is the <code>ANN(Approximate Nearest Neighbor)</code> search with the stored vector&rsquo;s id.
The id should already exist in the NGT indexes before the search process.
The search algorithm is the same as <code>Search</code>.</li></ul></li><li><p>LinearSearch</p><ul><li><code>LinearSearch</code> is the primary search algorithm with a query vector.
It searches all indexed vectors and calculates the distance between the query.
Its accuracy is exact, but the search time requires more than <code>Search</code> (ANN search) and increases the amount of indexed vector.</li></ul></li><li><p>LinearSearchById</p><ul><li><code>LinearSearchById</code> is the primary search algorithm with the vector&rsquo;s id.
The id should already exist in the NGT indexes before the search process.
The search algorithm is the same as <code>LinearSearch</code>.</li></ul></li></ol><div class=notice>Linear Search service is available from Vald v1.4 or later.</div><p>For more details, please refer to <a href=/docs/v1.5/api/search>the Search API document</a>.</p><h2 id=configuration>Configuration</h2><p>Here is the current search config parameters.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>// Represent search configuration.
</span></span><span style=display:flex><span>message Config <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  // Unique request ID.
</span></span><span style=display:flex><span>  string request_id <span style=color:#f92672>=</span> 1;
</span></span><span style=display:flex><span>  // Maximum number of result to be returned.
</span></span><span style=display:flex><span>  uint32 num <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>[</span> <span style=color:#f92672>(</span>validate.rules<span style=color:#f92672>)</span>.uint32.gte <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>  // Search radius.
</span></span><span style=display:flex><span>  float radius <span style=color:#f92672>=</span> 3;
</span></span><span style=display:flex><span>  // Search coefficient.
</span></span><span style=display:flex><span>  float epsilon <span style=color:#f92672>=</span> 4;
</span></span><span style=display:flex><span>  // Search timeout in nanoseconds.
</span></span><span style=display:flex><span>  int64 timeout <span style=color:#f92672>=</span> 5;
</span></span><span style=display:flex><span>  // Ingress filter configurations.
</span></span><span style=display:flex><span>  Filter.Config ingress_filters <span style=color:#f92672>=</span> 6;
</span></span><span style=display:flex><span>  // Egress filter configurations.
</span></span><span style=display:flex><span>  Filter.Config egress_filters <span style=color:#f92672>=</span> 7;
</span></span><span style=display:flex><span>  // Minimum number of result to be returned.
</span></span><span style=display:flex><span>  uint32 min_num <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span> <span style=color:#f92672>[</span> <span style=color:#f92672>(</span>validate.rules<span style=color:#f92672>)</span>.uint32.gte <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=request_id>request_id</h3><p><code>request_id</code> is a unique request ID.
It is <strong>NOT</strong> indexed vector&rsquo;s id.
Users can use it for, e.g., the error handling process.</p><h3 id=num>num</h3><p><code>num</code> is the maximum number of search results you&rsquo;d like to get.
<code>num</code> should be a positive integer.</p><h3 id=radius>radius</h3><p><code>radius</code>, the specific parameter for NGT, specifies the search range centered on the query vector in terms of the radius of a sphere.
The number of search target vectors increases along with the radius is large.
There is a trade-off between accuracy and search speed.
It is hard to set it depending on the dataset in many cases.</p><p>The default value is infinity.
When setting a negative number as <code>radius</code>, <code>NGT</code> applies the radius as infinity.</p><div class=notice>NGT will self-update the radius during the search process.</div><h3 id=epsilon>epsilon</h3><p><code>epsilon</code>, the specific parameter for NGT, specifies the search range&rsquo;s magnification coefficient (epsilon).
NGT will use <code>radius*(1+epsilon)</code> as the search range.
The number of search target vectors increases along with the epsilon being large.</p><p>The default value is 0.1, and it may work in most cases.
However, the appropriate value may vary depending on the dataset.
While it is desirable to adjust this value within 0 - 0.3, it can also set a negative value (over than -1).</p><h3 id=ingress_filters>ingress_filters</h3><p><code>ingress_filters</code> is required when using the ingress filter component.
It requires the ingress filter component&rsquo;s hostname and port.</p><h3 id=egress_filters>egress_filters</h3><p><code>egress_filters</code> is required when using the egress filter component.
It requires the egress filter component&rsquo;s hostname and port.</p><h3 id=min_num>min_num</h3><p><code>min_num</code> is the minimum number of search results you&rsquo;d like to get at least.
It helps you avoid the timeout error when the search process requires more time.
<code>min_num</code> should be a positive integer and smaller than <code>num</code>.</p></div><aside class=current id=current><button class=menu><span class=dot></span></button><nav id=TableOfContents><ul><li><a href=#vald-search-service>Vald Search Service</a></li><li><a href=#configuration>Configuration</a><ul><li><a href=#request_id>request_id</a></li><li><a href=#num>num</a></li><li><a href=#radius>radius</a></li><li><a href=#epsilon>epsilon</a></li><li><a href=#ingress_filters>ingress_filters</a></li><li><a href=#egress_filters>egress_filters</a></li><li><a href=#min_num>min_num</a></li></ul></li></ul></nav></aside></div></div></main><footer class=footer><div class=footer__content><ul class=footer__index><li class=footer__item><a href=/docs/v1.5/overview/about-vald class=footer__link>About<br></a></li><li class=footer__item><a href=/docs/v1.5/tutorial/get-started class=footer__link>Get Started<br></a></li><li class=footer__item><a href=/docs/v1.5/user-guides/sdks class=footer__link>SDKs</a></li><li class=footer__item><a href=/docs/v1.5 class=footer__link>Docs</a></li><li class=footer__item><a href=https://vdaas-vald.medium.com/ target=_blank class=footer__link>Blog<br></a></li></ul><ul class=footer__sns><li class=footer__item><a class="footer__item footer__icon" href=https://twitter.com/vdaas_vald target=_blank><picture><source srcset=https://vald.vdaas.org/images/logo_x_white.svg media="(prefers-color-scheme: dark)" class=icon__image width=24 height=24><img src=https://vald.vdaas.org/images/logo_x_black.svg alt=x class=icon__image></picture></a></li><li class=footer__item><a class="footer__item footer__icon" href=https://join.slack.com/t/vald-community/shared_invite/zt-db2ky9o4-R_9p2sVp8xRwztVa8gfnPA target=_blank><picture><source srcset=https://vald.vdaas.org/images/logo_slack_white.svg media="(prefers-color-scheme: dark)" class=icon__image width=24 height=24><img src=https://vald.vdaas.org/images/logo_slack_black.svg alt=slack class=icon__image></picture></a></li><li class=footer__item><a class="footer__item footer__icon" href=https://github.com/vdaas/vald target=_blank><picture><source srcset=https://vald.vdaas.org/images/logo_github_white.svg media="(prefers-color-scheme: dark)" class=icon__image width=24 height=24><img src=https://vald.vdaas.org/images/logo_github_black.svg alt=github class=icon__image></picture></a></li></ul></div><p class=footer__copylight>Â©2019-2022 vald.vdaas.org Vald team</p></footer></body></html>